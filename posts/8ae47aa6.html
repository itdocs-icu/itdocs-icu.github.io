<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          广告全链路分析路径 - Docs`Blog
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre-exp.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<link rel="stylesheet" href="/css/mdicon.css">

    
<script src="/js/book.js"></script>

    
<script src="/js/jquery.min.js"></script>

<!--   之前的code复制按钮  
<script src="/js/clipboard.min.js"></script>
-->
<!--    code-->
    
<link rel="stylesheet" href="/css/prism.css">

    
<script src="/js/prism.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async></script>


    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

    
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">


    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'G-3FTL9QWCS6', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>


<meta name="generator" content="Hexo 5.4.2"></head>


<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>DOCS`BLOG</span>
  </a>
</div>
    <div class="tree" id="tree">
    <input id="search-input" class="search-input" type="text" placeholder="search...">
    

    
        <ul>
            <li class="directory">
                <a class="directory">
                    <i class="material-icons">keyboard_arrow_right</i>
                    Linux
                </a>
                
        <ul>
            <li class="file">
                <a href="/posts/fc209c86.html">
                    linux_nvm安装
                </a>
            </li>
            <div class="article-toc" style="display: none;"></div>
        </ul>
    
            </li>

        </ul>
    
        <ul>
            <li class="directory">
                <a class="directory">
                    <i class="material-icons">keyboard_arrow_right</i>
                    商业化
                </a>
                
        <ul>
            <li class="file active">
                <a href="/posts/8ae47aa6.html">
                    广告全链路
                </a>
            </li>
            <div class="article-toc" style="display: none;"></div>
        </ul>
    
        <ul>
            <li class="file">
                <a href="/posts/fca0e48c.html">
                    互联网的半壁江山
                </a>
            </li>
            <div class="article-toc" style="display: none;"></div>
        </ul>
    
        <ul>
            <li class="file">
                <a href="/posts/b4bce7a2.html">
                    互联网广告专业术语
                </a>
            </li>
            <div class="article-toc" style="display: none;"></div>
        </ul>
    
            </li>

        </ul>
    
        <ul>
            <li class="directory">
                <a class="directory">
                    <i class="material-icons">keyboard_arrow_right</i>
                    Feel
                </a>
                
        <ul>
            <li class="file">
                <a href="/posts/48120bab.html">
                    Tensorflow联邦学习平台搭建
                </a>
            </li>
            <div class="article-toc" style="display: none;"></div>
        </ul>
    
        <ul>
            <li class="file">
                <a href="/posts/f41c51aa.html">
                    工作方式
                </a>
            </li>
            <div class="article-toc" style="display: none;"></div>
        </ul>
    
            </li>

        </ul>
    
</div>



<script src="/js/book-menu.js"></script>


  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>


  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h2 id="广告和它的分类">广告和它的分类</h2>
<p>广告，广而告之。在信息大爆炸的今天，酒香更怕巷子深了。如何尽快提高自己的曝光度，把产品推销给潜在受众，就成大部分商家的问题。</p>
<p>当前，广告可以分为两种：<code>品牌广告</code>和<code>效果广告</code>。</p>
<h3 id="品牌广告">品牌广告</h3>
<p>品牌广告是最原始的广告，它的主要目的是进行商家品牌的塑造。多采用销售员和商家谈合约的方式进行售卖，单笔的交易额较大，定向并不准确，往往是CPT售卖。比如说奔驰在腾讯视频网站首页的广告，也不管笔者是不是买得起奔驰，直接就展示了出来。</p>
<p><img src="https://cdn.jsdelivr.net/gh/itdocs-icu/img/img/20211117110934.png" alt=""></p>
<blockquote>
<p><code>CPM: </code>广告最主要的计费手段，按每千次曝光来计费，其他计费方式也会最终转换为CPM来横向衡量它的价值<br>
<code>CPT: </code>按广告展示的单位时间来计费，比如说8W/天<br>
<code>CPC: </code>按用户的每次点击广告来计费<br>
<code>CPA: </code>按用户的每次行动来计费，比如说填一个问卷或者注册<br>
<code>CPS: </code>按实际的销售额来计费，如销售某件商品</p>
</blockquote>
<h3 id="效果广告">效果广告</h3>
<p>毫无疑问，品牌广告有个很大的问题在于，大量的广告费用被浪费在了非潜在用户身上。这对于小广告主——往往广告预算有限——是非常不友好的。而效果广告就是通过精准的定向，任意的购买数量，实时竞价的价格，迅速抢占了除了头部流量之外的其他流量。时至今日，数字化营销已经大行其道，效果广告也已经成了业界的主流.</p>
<h3 id="效果广告流程">效果广告流程</h3>
<h2 id=""><img src="https://cdn.jsdelivr.net/gh/itdocs-icu/img/img/20211117111624.png" alt=""></h2>
<p><img src="https://cdn.jsdelivr.net/gh/itdocs-icu/img/img/20211117111924.png" alt="DSP-SSP"></p>
<blockquote>
<p><code>DSP:</code> 需求方平台。广告主用来进行购买广告的平台。<br>
<code>ADX:</code> 对接多个DSP和SSP，提供实时竞价的平台。<br>
<code>SSP:</code> 供应方平台。为资源提供方服务，处理一些用户纬度逻辑，管理广告位等。<br>
<code>DMP:</code> 第三方数据管理平台。为DSP，ADX，甚至SSP提供用户维度服务。<br>
<code>RTB:</code> 实时竞价</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/itdocs-icu/img/img/20211117112516.png" alt=""></p>
<p>让我们来整体过一下上面这张图，它可以分为N个步骤：</p>
<ol>
<li>广告主A想购买北上广三地的广告，所以他在某一个DSP上选择了“大城市维度”，并以8元/CPM的价格下单了10000CPM。</li>
<li>当一个用户浏览媒体时，前端会迅速发送一个广告请求并带上用户的相关数据</li>
<li>SSP把这个用户的相关信息进行维度拆分，例如30岁，上海，男性等，然后把这个曝光机会发送给ADX</li>
<li>各DSP在ADX上对这个曝光机会进行竞拍，如果我们以20元/CPM的价格竞拍成功，广告主A就获得了这次展示机会</li>
<li>SSP会获得广告主A的素材，然后再把这个素材传给前端</li>
<li>前端根据素材进行渲染，用户从而在媒体上看到广告</li>
</ol>
<p>整个流程会在100ms以内完成。你可能也已经发现了，广告购买售卖的核心是RTB，那么RTB是怎么实现的呢？</p>
<h2 id="广告核心：RTB">广告核心：RTB</h2>
<p>要做到RTB，需要明确两个点，一个是该卖给谁，一个是还有多少货。举个例子：A每天卖200个西瓜。用户B愿意出5元/个的价格买3个，用户C愿意以10元/个买2个，用户D愿意以2元/个的价格买1000个，两天内交货。</p>
<p>当然了，我们要先卖高价，然后再卖低价。同时，还需要考虑下是否能满足D的订单，否则可能背上官司。卖给谁的问题就是竞价，而能不能满足订单就是库存。</p>
<h3 id="竞价算法">竞价算法</h3>
<h4 id="GSP（广义第一高价）">GSP（广义第一高价）</h4>
<p>这个算法是97年提出的。它很好理解，谁出价高广告就卖给谁。像下面的这种情况，无脑卖给广告主A。</p>
<p>广告主	出价<br>
A	10元/CPM<br>
B	4元/CPM</p>
<p>但是这种算法不是没有问题的。广告主总是会倾向于出最少的钱，他会使用自动竞价工具反复试探当前的最高出价，然后再自己的承受范围内加一点，加一点。像上面的这个例子，如果没有底价的话，广告主A和B都会从0.1元开始，一直加到4元，然后B放弃了竞价，A马上又把价格降低为0.1元，B察觉到后又会重新加入到竞拍中，终而复始…</p>
<p><img src="https://cdn.jsdelivr.net/gh/itdocs-icu/img/img/20211117113113.png" alt=""></p>
<p>这就造成了媒体收益的剧烈波动，另外不断的竞价嗅探也给整个平台造成了巨大的性能负担。</p>
<h4 id="GSP（广义第二高价）">GSP（广义第二高价）</h4>
<p>要是能让广告主减少不断变化的出价欲望就好了，GSP就是这样的一个算法——广告主按照自己的出价报价，但是按照第二高价付钱。例如3.1.1的例子中，A按照10元的报价拿到了曝光的机会，但是这次曝光只需要付出4元，所以实际的价格也是4元/CPM。在这种情况下，广告主并不会有特别的欲望频繁修改自己的出价。</p>
<p>2002年Google一推出GSP，就因为它的稳定性和通俗易懂，很快成为了主流的竞价方式，并沿用至今。</p>
<p>除了第二高价之外，GSP还引入了quality（广告因子）的概念。广告的竞价排序不再单纯是出价的高低了，而是</p>
<p><code>竞价排序 = 出价 * quality</code><br>
quality包含几千个维度，主要用于计算广告和用户的匹配程度，包括但不限于素材，上下文，时间，用户历史点击行为，广告类别，用户的人口属性等。这样的设计保证了广告的点击率，从而保证了媒体的利益。</p>
<blockquote>
<p>《浪潮之巅》中举过一个例子，AMD以1元/CPM的价格购买定向AMD的广告，但是Intel为了不让AMD做宣传，花4元/CPM的价格买下了所有的曝光机会。然而4元/CPM的价格对Intel来说也是亏本的，所以它通过CPC的方式来购买广告，并将广告素材改为了Coca Cola。由于定向不同，没有多少人会去点击广告，Intel花了很少的钱就打击了AMD。</p>
</blockquote>
<h4 id="VCG">VCG</h4>
<p>GSP也不是一劳永逸，广告主B发现广告主A总是用较少的价格就能获取到曝光，他经过反复的尝试，判断出了广告主A 10元/CPM的报价，从而将报价改为9.9元。这样就可以快速消耗广告主A的广告预算，从而为自己获得曝光。广告主A发现自己的收益降低，也不甘示弱，降低为9.8元/CPM，广告主B从而以过高的价格获得了大量曝光，亏了一笔。于是广告主B又将价格降低为9.7元/CPM，继续坑广告主A…</p>
<p>当然啦，实际的情况会比这个复杂很多，再有多个广告主，多个广告位的情况下，广告主很难找到一个合理的价格去坑对手。更何况这个操作的收益来的如此不明显。所以当前广告主还是更关注自己ROI（投资回报率），而不是干些刻意损人不利己的勾当。</p>
<p>但是从理论上来说，这种情况确实存在。有没有一种算法可以实现让每个广告主都可以坦诚的说出自己的价格，并且获得最大的收益？这种算法就是VCG。它是为了最大的社会价值而生的。要解释它，可以举个例子。</p>
<table>
<thead>
<tr>
<th>广告主</th>
<th>盈利</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>10元/CPM</td>
</tr>
<tr>
<td>B</td>
<td>4元/CPM</td>
</tr>
<tr>
<td>C</td>
<td>2元/CPM</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>广告位</th>
<th>库存</th>
</tr>
</thead>
<tbody>
<tr>
<td>1号</td>
<td>150CPM</td>
</tr>
<tr>
<td>2号</td>
<td>100CPM</td>
</tr>
</tbody>
</table>
<p>假设每个广告主只买一个广告位，在广告主A在不参与竞拍的情况下，BC广告主共收益150 4 + 100 2 = 800元，但是由于A广告主参与了竞拍，所以BC广告主的收益变成了100 * 4 = 400元，所以A广告主需要付出400元来买到1号这些CPM，单价为400 / 150 = 2.6元/CPM。同理，B广告主需要付出2元/CPM。所以媒体的总收益为600元。</p>
<p>对比GSP的800元，VCG的收益明显是少了。这一部分的权益被让利给了广告主。事实上，数据推导证明，对于媒体来说，所有的GSP都比VCG盈利的多。但是长期来看，如果广告主接受并认可这种竞价方式，媒体也可能在市场占有率上获得回报，这也就是FaceBook为什么选择这种竞价方式的原因。</p>
<h3 id="库存算法">库存算法</h3>
<p>刚才我们讨论了竞价，现在我们来讨论下库存。对于异常事件，库存预估算法是无能为力的，库存预估只能对大多数普遍的情况的作出预估。当前的库存预估算法主要有两种。</p>
<h4 id="建立数学模型">建立数学模型</h4>
<p>通过对与库存强相关维度的分析，把维度当作参数构建数学模型，然后通过输入不同的维度值就可以得到最终的库存走势。</p>
<h4 id="根据ARIMA模型">根据ARIMA模型</h4>
<p>将离散的指经过数学处理，变为均衡波动的值，延伸这个均衡波动，反推从而推断离散的值。ARIMA是一种自线性回归模型，至于为什么不选择其他模型，是因为它的效果较好。</p>
<h2 id="总结">总结</h2>
<p>本文描述了广告的全链路和相关的算法知识，受限于库存算法的复杂性和个人知识面，只粗略的提出了两个方案（广平使用的）。但是对于大家了解广告的玩法，还是希望能起到一定的借鉴意义。</p>
<p>补充：发现了一本广告系列的电子书，推荐给大家《广告算法学习笔记》</p>
<p><a target="_blank" rel="noopener" href="https://www.kancloud.cn/bigheadyushan/learning_notes_of_advertising_algorithms/603682">https://www.kancloud.cn/bigheadyushan/learning_notes_of_advertising_algorithms/603682</a></p>

</div>

<!--上一篇 下一篇-->


  <div class="paginator">
    
      
        
      
    
      
        
      
    
      
         <!-- 先找到与当前文字相同的目录 -->
        
        
          
           <!-- 在找到当前文章所在的 index -->
          
          
            
            
            
          
            
              <!-- 上一篇文章 ⇨ -->
            <div class="prev">
<!--              <span>上一章</span>-->
              <a href="/posts/fca0e48c.html"> 互联网财富的半壁江山：广告  → </a>
              <span class="material-icons right">  </span>
            </div>
            
            
          
            
            
            
          
          
        
          
          
        
          
          
        
        
      
    
  </div>




  <div class="book-comments">
    


    <script src="https://giscus.app/client.js"
            data-repo="A2Data/itdocs_giscus"
            data-repo-id="R_kgDOHPLRRw"
            data-category="Announcements"
            data-category-id="DIC_kwDOHPLRR84COyJ5"
            data-mapping="pathname"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="top"
            data-theme="light"
            data-lang="zh-CN"
            data-loading="lazy"
            crossorigin="anonymous"
            async>
    </script>






  </div>



<script src="/js/book-post.js"></script>



<div class="book-footer">
  <div class="pure">
    <script src="https://pv.sohu.com/cityjson?ie=utf-8"></script>
    <script>
      var getOSAndBrowser = function () {
        var os = navigator.platform;
        var userAgent = navigator.userAgent;
        var info = "";
        var tempArray = "";
        if (os.indexOf("Win") > -1) {
          if (userAgent.indexOf("Windows NT 5.0") > -1) {
            info += "Win2000"
          } else if (userAgent.indexOf("Windows NT 5.1") > -1) {
            info += "WinXP"
          } else if (userAgent.indexOf("Windows NT 5.2") > -1) {
            info += "Win2003"
          }
          else if (userAgent.indexOf("Windows NT 6.0") > -1) {
            info += "WindowsVista"
          } else if (userAgent.indexOf("Windows NT 6.1") > -1 || userAgent.indexOf("Windows 7") > -1) {
            info += "Win7"
          } else if (userAgent.indexOf("Windows NT 6.2") > -1 || userAgent.indexOf("Windows 8") > -1) {
            info += "Win8"
          }
          else if (userAgent.indexOf("Windows NT 6.3") > -1 || userAgent.indexOf("Windows 8.1") > -1) {
            info += "Win8.1"
          } else if (userAgent.indexOf("Windows NT 10.0") > -1 || userAgent.indexOf("Windows 10") > -1) {
            info += "Win10"
          } else {
            info += "Other"
          }
        } else if (os.indexOf("Mac") > -1) {
          info += "Mac"
        } else if (os.indexOf("X11") > -1) {
          info += "Unix"
        } else if (os.indexOf("Linux") > -1) {
          info += "Linux"
        } else { info += "Other" } info += "/";
        var isOpera = userAgent.indexOf("Opera") > -1;
        var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1 && !isOpera;
        var isEdge = userAgent.toLowerCase().indexOf("edge") > -1 && !isIE;
        var isIE11 = (userAgent.toLowerCase().indexOf("trident") > -1 && userAgent.indexOf("rv") > -1);
        if (/[Ff]irefox(\/\d+\.\d+)/.test(userAgent)) {
          tempArray = /([Ff]irefox)\/(\d+\.\d+)/.exec(userAgent);
          info += tempArray[1] + tempArray[2]
        } else if (isIE) {
          var version = "";
          var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
          reIE.test(userAgent);
          var fIEVersion = parseFloat(RegExp["$1"]);
          if (fIEVersion == 7) {
            version = "IE7"
          } else if (fIEVersion == 8) {
            version = "IE8"
          } else if (fIEVersion == 9) { version = "IE9" } else if (fIEVersion == 10) { version = "IE10" } else { version = "0" } info += version
        } else if (isEdge) { info += "Edge" } else if (isIE11) { info += "IE11" } else if (/[Cc]hrome\/\d+/.test(userAgent)) { tempArray = /([Cc]hrome)\/(\d+)/.exec(userAgent); info += tempArray[1] + tempArray[2] } else if (/[Vv]ersion\/\d+\.\d+\.\d+(\.\d)* *[Ss]afari/.test(userAgent)) { tempArray = /[Vv]ersion\/(\d+\.\d+\.\d+)(\.\d)* *([Ss]afari)/.exec(userAgent); info += tempArray[3] + tempArray[1] } else if (/[Oo]pera.+[Vv]ersion\/\d+\.\d+/.test(userAgent)) { tempArray = /([Oo]pera).+[Vv]ersion\/(\d+)\.\d+/.exec(userAgent); info += tempArray[1] + tempArray[2] } else { info += "unknown" } return info
      };
      document.write("欢迎来自" + returnCitySN["cname"] + "的朋友");
      document.write(" <br> 您的 IP 是:" + returnCitySN["cip"]);
      document.write(",您使用的是:" + getOSAndBrowser());
    </script>
  </div>
  <div>
    <span id="timeDate"></span>
    <i class="fa fa-heartbeat" aria-hidden="true" style="color:rgba(255,0,0,.9)" ></i>
    <span id="times"></span>
    <i class="fa fa-heartbeat" aria-hidden="true" style="color:rgba(255,0,0,.9)" ></i>
    <script>
      var now = new Date();
      function createtime() {
        var grt= new Date("07/21/2021 00:00:00");  //在此处修改你的建站时间，格式：月/日/年 时:分:秒
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        // document.getElementById("timeDate").innerHTML = "本站已运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = "本站已运行 "+dnum+" 天 "+ hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
      }
      setInterval("createtime()",250);
    </script>

  </div>
  <div class="github-badge">
    <a style="color: #fff" rel="license" href="https://www.a2data.cn/" target="_blank" title="DataScience提供内容创作">
      <span class="badge-subject">Copyright©2021</span><span class="badge-value bg-blueviolet">DataBricks</span></a>
  </div>
  <div class="github-badge">
    <a style="color: #fff" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="本站点采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可">
      <span class="badge-subject"><i class="fa fa-copyright"></i></span><span class="badge-value bg-lightgrey">BY-NC-SA 4.0</span></a>
  </div>
  <div class="github-badge">
    <a style="color: #fff" rel="license" href="https://beian.miit.gov.cn/" target="_blank" title="[互联网文档]">
      <span class="badge-subject">京ICP</span><span class="badge-value bg-red">备20010978号-3</span></a>
  </div>
</div>

<script>
  function listennSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    const sections = [...navItems].map((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
              decodeURI(link.getAttribute("href")).replace("#", "")
      );
      link.addEventListener("click", (event) => {
        event.preventDefault();
        window.scrollTo({
          top: target.offsetTop,
          behavior: "smooth"
        });
      });
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      $('.toc-link').removeClass('active_b');
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    function findIndex(entries) {
      let index = 0;
      let entry = entries[index];
      if (entry.boundingClientRect.top > 0) {
        index = sections.indexOf(entry.target);
        return index === 0 ? 0 : index - 1;
      }
      for (; index < entries.length; index++) {
        if (entries[index].boundingClientRect.top <= 0) {
          entry = entries[index];
        } else {
          return sections.indexOf(entry.target);
        }
      }
      return sections.indexOf(entry.target);
    }

    function createIntersectionObserver(marginTop) {
      marginTop = Math.floor(marginTop + 10000);
      let intersectionObserver = new IntersectionObserver(
              (entries, observe) => {
                let scrollHeight = document.documentElement.scrollHeight;
                if (scrollHeight > marginTop) {
                  observe.disconnect();
                  createIntersectionObserver(scrollHeight);
                  return;
                }
                let index = findIndex(entries);
                activateNavByIndex(navItems[index]);
              },
              {
                rootMargin: marginTop + "px 0px -100% 0px",
                threshold: 0,
              }
      );
      sections.forEach((element) => {
        element && intersectionObserver.observe(element);
      });
    }
    createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", listennSidebarTOC);
  document.addEventListener("pjax:success", listennSidebarTOC);
</script>

<style>
  .github-badge {
    display:inline-block;
    border-radius:4px;
    text-shadow:none;
    font-size:13px;
    color:#fff;
    line-height:15px;
    background-color:#ABBAC3;
    margin-bottom:5px;
  }
  .github-badge .badge-subject {
    display:inline-block;
    background-color:#4D4D4D;
    padding:4px 4px 4px 6px;
    border-top-left-radius:4px;
    border-bottom-left-radius:4px;
  }
  .github-badge .badge-value {
    display:inline-block;
    padding:4px 6px 4px 4px;
    border-top-right-radius:4px;
    border-bottom-right-radius:4px;
  }
  .github-badge .bg-brightgreen {
    background-color:#4DC820 !important;
  }
  .github-badge .bg-orange {
    background-color:#FFA500 !important;
  }
  .github-badge .bg-yellow {
    background-color:#D8B024 !important;
  }
  .github-badge .bg-blueviolet {
    background-color:#8833D7 !important;
  }
  .github-badge .bg-pink {
    background-color:#F26BAE !important;
  }
  .github-badge .bg-red {
    background-color:#e05d44 !important;
  }
  .github-badge .bg-blue {
    background-color:#007EC6 !important;
  }
  .github-badge .bg-lightgrey {
    background-color:#9F9F9F !important;
  }
  .github-badge .bg-grey, .github-badge .bg-gray {
    background-color:#555 !important;
  }
  .github-badge .bg-lightgrey, .github-badge .bg-lightgray {
    background-color:#9f9f9f !important;
  }
</style>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/jack.png" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>JackFeng</div>
      <div>2021-11-17</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/%E5%95%86%E4%B8%9A%E5%8C%96/">商业化</a>

      <a class="tag-none-link" href="/tags/%E5%B9%BF%E5%91%8A/" rel="tag">广告</a>
    </div>

  

  <div class="divider"></div>
</div>

  
  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>


</div>

      </div>
    </div>
  </div>

  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

<script>(function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined') return; w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; var js, fjs = d.getElementsByTagName(s)[0]; js = d.createElement(s); js.id = id; js.async = 1; js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window, document, 'script', 'webpushr-jssdk'));webpushr('setup', { 'key': 'BFx7WHz0rVpOVN8atT9J94hKkLItiL6wLbP5k5sJJtdQyWv9pryOWtscXADG3vfDUZzp89H1H3q34GSQXcr23Gw' });</script></body>
</html>


<script src="/js/book.js"></script>


<link rel="stylesheet" href="/css/prism.css">


<script src="/js/prism.js"></script>




<!--动态线条-->
<!--<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/canvas-nest.min.js"></script>-->

<!--彩带-->
<!--<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/piao.js"></script>-->
